<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Sven Buerki &amp; Anthony Melton - Boise State University" />

<meta name="date" content="2021-03-22" />

<title>BIOL 497/597 - Genomics &amp; Bioinformatics</title>

<script src="site_libs/header-attrs-2.6/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<style type="text/css">
/* for pandoc --citeproc since 2.11 */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Genomics & Bioinformatics</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="Mini_reports.html">Mini-reports</a>
</li>
<li>
  <a href="Chapters.html">Chapters</a>
</li>
<li>
  <a href="Mining_draft_genome.html">Lab.</a>
</li>
<li>
  <a href="Tutorials.html">Tutorials</a>
</li>
<li>
  <a href="Lexicon.html">Lexicon</a>
</li>
<li>
  <a href="References.html">References</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">BIOL 497/597 - Genomics &amp; Bioinformatics</h1>
<h3 class="subtitle">Lab: Mining sagebrush draft genome</h3>
<h4 class="author">Sven Buerki &amp; Anthony Melton - Boise State University</h4>
<h4 class="date">2021-03-22</h4>

</div>


<script type="text/javascript">
$(document).ready(function() {
  $('#header').parent().prepend('<div id=\"logo\"><img src=\"Images/boisestate-primarylogo-2color-rgb.png\" style=\"position:absolute; top:0; right:0; padding:10px; height:120px\"></div>');
  $('#header').css('margin-right', '120px')
});
</script>
<div id="intro" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Introduction</h1>
<p>This document supports analyses aiming at mining the sagebrush (<em>Artemisia tridentata</em> Nutt; Asteraceae) draft genome for Aquaporin (AQP) genes. AQPs are multi-exon genes (see Figure <a href="#fig:multigene">1.1</a>) encoding for a large family of proteins known to function in the transport of water and other molecules across cell membranes <span class="citation">(reviewed in <a href="#ref-li2014plant" role="doc-biblioref">Li et al., 2014</a>)</span>.</p>
<div class="figure"><span id="fig:multigene"></span>
<img src="Images/multi_exon_gene.png" alt="Flowchart showing the structure of a multi-exon gene and different resulting proteins. As a reminder, exons are pieces of coding DNA that encode proteins. Different exons code for different domains of a protein. The domains may be encoded by a single exon or multiple exons spliced together. In the case of multi-exon genes, the presence of exons and introns allows for greater molecular evolution through the process of exon shuffling and alternative splicing. Exon shuffling occurs when exons on sister chromosomes are exchanged during recombination. This allows for the formation of new genes. On the other hand, exons also allow for multiple proteins to be translated from the same gene through alternative splicing. This process allows the exons to be arranged in different combinations when the introns are removed/spliced. The different configurations can include the complete removal of an exon, the inclusion of part of an exon, or the inclusion of part of an intron. Alternative splicing can occur in the same location to produce different variants of a gene with a similar role, such as the human slo gene, or it can occur in different cell or tissue types, such as the mouse alpha-amylase gene. Alternative splicing, and defects in alternative splicing, can result in a number of diseases including cancer." width="80%" />
<p class="caption">
Figure 1.1: Flowchart showing the structure of a multi-exon gene and different resulting proteins. As a reminder, exons are pieces of coding DNA that encode proteins. Different exons code for different domains of a protein. The domains may be encoded by a single exon or multiple exons spliced together. In the case of multi-exon genes, the presence of exons and introns allows for greater molecular evolution through the process of exon shuffling and alternative splicing. Exon shuffling occurs when exons on sister chromosomes are exchanged during recombination. This allows for the formation of new genes. On the other hand, exons also allow for multiple proteins to be translated from the same gene through alternative splicing. This process allows the exons to be arranged in different combinations when the introns are removed/spliced. The different configurations can include the complete removal of an exon, the inclusion of part of an exon, or the inclusion of part of an intron. Alternative splicing can occur in the same location to produce different variants of a gene with a similar role, such as the human slo gene, or it can occur in different cell or tissue types, such as the mouse alpha-amylase gene. Alternative splicing, and defects in alternative splicing, can result in a number of diseases including cancer.
</p>
</div>
<p>The defining characteristics of AQP proteins include having six membrane-spanning alpha-helices and two hydrophobic loops containing conserved asparagine-proline-alanine (NPA) motif which form a barrel surrounding a central pore-like region that contains additional protein density (see Figure <a href="#fig:AQPex">1.2</a>). While the NPA motifs are generally highly conserved, there are some AQP genes that have undergone mutations of the alanine residue in the NPA motif <span class="citation">(<a href="#ref-ishibashi2006aquaporin" role="doc-biblioref">Ishibashi, 2006</a>)</span>. AQPs in flowering plants comprise five subfamilies: (1) NOD26-like intrinsic proteins (NIPs), (2) plasma membrane intrinsic proteins (PIPs), (3) small basic intrinsic proteins (SIPs), (4) tonoplast intrinsic proteins (TIPs), and (5) X intrinsic proteins (XIPs) <span class="citation">(<a href="#ref-danielson2008unexpected" role="doc-biblioref">Danielson and Johanson, 2008</a>)</span>. Genes from each subfamily tend to move water or other substrate depending on their NPA motifs. Some AQPs, such as NIPs, have acquired a mutation in their NPA motif, such as alanine to leucine, which confer the ability to move substrates such as urea or ammonium <span class="citation">(reviewed in <a href="#ref-chaumont2005regulation" role="doc-biblioref">Chaumont et al., 2005</a>)</span>.</p>
<div class="figure" style="text-align: center"><span id="fig:AQPex"></span>
<img src="Images/NIP5-1_At_Sc466867.png" alt="Example of a 3D model of an Aquaporin protein recovered in the sagebrush genome. NPA motifs are shown by red/orange colors" width="50%" />
<p class="caption">
Figure 1.2: Example of a 3D model of an Aquaporin protein recovered in the sagebrush genome. NPA motifs are shown by red/orange colors
</p>
</div>
</div>
<div id="learning-outcomes" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Learning outcomes</h1>
<p>As part of this lab, students will gain the following learning outcomes:</p>
<ol style="list-style-type: decimal">
<li>Learn protocol to remotely access to a unix-based computer (see <a href="Tutorials.html">Tutorials</a>).</li>
<li>Learn unix-based commands to organize projects and execute code (see <a href="Tutorials.html">Tutorials</a>).</li>
<li>Provide introduction to running R code and developing your own R code (this topic was also partially covered in <a href="Mini_reports.html">Mini-Report 3</a>).</li>
<li>Study protocols to mine Illumina <em>de novo</em> draft genome (at scaffold level) for target genes.</li>
<li>Predict and annotate genes recovered from genome mining process.</li>
<li>Reconstruct protein sequences of annotated genes.</li>
<li>Validate protein sequence and predict function.</li>
</ol>
</div>
<div id="objectives-and-scientific-question" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Objectives and scientific question</h1>
<p>Instructors teach students to conduct analyses by going over each module in class demonstrating the approach to mine genome for target gene and go over steps to assemble and validate protein product. Then, each group will be assigned a scaffold (from the <em>de novo</em> genome assembly) and they will have to conduct analyses presented in modules 2 to 4 on their own to answer the following question:</p>
<blockquote>
<p>What Aquaporin protein coding sequence is “hidden” in your assigned scaffold?</p>
</blockquote>
<p>Very much the same as with the “Where’s waldo?” children books, students will be able to make predictions to “find” their Aquaporin protein coding sequence based on material presented in the <a href="#intro">Introduction</a> and further developed in modules <a href="#mod2">2</a>, <a href="#mod3">3</a> and <a href="#mod4">4</a>. These material will allow students to design their analytical workflow covering the following major steps:</p>
<ol style="list-style-type: decimal">
<li>Predict, annotate and identify AQP genes along scaffold.</li>
<li>Reconstruct and validate AQP protein sequences.</li>
<li>Predict AQP protein function (by intersecting evidence recovered from the previous steps).</li>
</ol>
<div id="scaffolds-assigned-to-groups" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Scaffolds assigned to groups</h2>
<p>The <code>FASTA</code> file with scaffolds sequences can be downloaded <a href="Data/Scaffolds_groups.fasta">here</a>. The scaffolds assigned to each group are as followed:</p>
<ul>
<li><strong>Group A</strong>: Scaffold106379.</li>
<li><strong>Group B</strong>: Scaffold254734.</li>
<li><strong>Group C</strong>: Scaffold348135.</li>
<li><strong>Group D</strong>: Scaffold355053.</li>
</ul>
<p>Let’s complete the training first going by through each module and then students will be working in groups to replicate this approach to their assigned scaffold. Fridays of weeks #12 and 13 will be dedicated to group work using Zoom breakout rooms.</p>
</div>
</div>
<div id="analytical-workflow" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Analytical workflow</h1>
<p>Overall, our analytical workflow is subdivided into 4 modules as follows:</p>
<ul>
<li><a href="#mod1"><strong>Module 1:</strong></a> Set-up environment and identify scaffolds containing AQP genes.</li>
<li><a href="#mod2"><strong>Module 2:</strong></a> Extract scaffolds identified in module 1 and find <strong>O</strong>pen <strong>R</strong>eading <strong>F</strong>rames.</li>
<li><a href="#mod3"><strong>Module 3:</strong></a> Annotate ORFs and assemble AQP protein(s).</li>
<li><a href="#mod4"><strong>Module 4:</strong></a> Validate AQP protein sequences and infer their function(s).</li>
</ul>
</div>
<div id="project-structure" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Project structure</h1>
<div id="where-are-the-data-located" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Where are the data located?</h2>
<p>All the data associated to this project are located on your individual account in the <code>DraftGenomeMineR/</code> folder. This folder is located in <code>/home/bio_11/DraftGenomeMineR</code>. Please replace <code>bio_11</code> by your <a href="https://docs.google.com/document/d/1t0DdQBes42Gzo8XWgc9JL2xEGjv1kbfoVE7Vznx6C9I/edit">account detail</a>.</p>
<p><strong>Key files:</strong></p>
<ul>
<li><code>Draft_Genome_Assembly.fasta</code>: Sagebrush draft genome assembly (at scaffold level).</li>
<li><code>FASTAs/PIP1_3.fa</code>: Reference containing <em>PIP1</em> gene (AA) for BLAST analysis. This data will be used to find Aquaporin genes in the draft genome.</li>
<li>Scripts related to each module are located in <code>Lesson_Modules/</code>.</li>
</ul>
</div>
<div id="how-do-i-access-the-data-and-run-analyses" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> How do I access the data and run analyses?</h2>
<p>To access the data and run the analyses, please remotely connect to your dedicated computer using <code>ssh</code> protocol. Your credentials are available <a href="https://docs.google.com/document/d/1t0DdQBes42Gzo8XWgc9JL2xEGjv1kbfoVE7Vznx6C9I/edit">here</a>.</p>
</div>
</div>
<div id="mod1" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Module 1</h1>
<div id="objectives" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> Objectives</h2>
<p>This module is dedicated to presenting approach to set-up your working environment and then to identify scaffolds in the <em>de novo</em> genome assembly containing AQP genes (using BLAST).</p>
</div>
<div id="remotely-connect-to-computer" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> Remotely connect to computer</h2>
<p>Start by using <code>ssh</code> protocol to connect to your Linux computer. This is done as follows (enter password when prompted to):</p>
<pre class="bash"><code>#SSH with bio_11 as example
ssh bio_11@132.178.142.214</code></pre>
</div>
<div id="copy-project-folder-to-remote-computer" class="section level2" number="6.3">
<h2><span class="header-section-number">6.3</span> Copy project folder to remote computer</h2>
<p>After downloading the <code>zip</code> file from our shared Google Drive to your personal computer, please copy this file to your Linux computer (on your personal account) as follows:</p>
<pre class="bash"><code>#scp file: general syntax
scp file user@host:dir

#Example
scp DraftGenomeMineR.zip bio_11@132.178.142.214:/home/bio_11

#unzip file
unzip DraftGenomeMineR.zip</code></pre>
<p><strong>Disclaimer:</strong> This procedure only works if you have a unix-based computer. If you don’t have a unix-based computer, please ask instructors to transfer this file for you to your account. However, students can <code>cp</code> this file by copying it from the <code>bioinformatics</code> account onto their Linux computer as follows:</p>
<pre class="r"><code>#Navigate where the zip file should reside (adjust path to your account ID)
cd /home/bio_11

#Copy the zip file (containing all data for project) on your Linux account
cp /home/bioinformatics/GenomeMining_Bioinformatics_2021/DraftGenomeMineR.zip .

#unzip file
unzip DraftGenomeMineR.zip</code></pre>
</div>
<div id="start-r-session" class="section level2" number="6.4">
<h2><span class="header-section-number">6.4</span> Start R session</h2>
<p>Navigate to <code>DraftGenomeMineR/</code> and start a new <code>R</code> session:</p>
<pre class="bash"><code>#Navigate to DraftGenomeMineR/
cd DraftGenomeMineR/

#Start R session
R-4</code></pre>
</div>
<div id="load-r-packages-and-user-defined-functions" class="section level2" number="6.5">
<h2><span class="header-section-number">6.5</span> Load R packages and user-defined functions</h2>
<p>Create an object with all the required R packages and load them:</p>
<pre class="r"><code># This will make a list of packages that another function will use to make sure they are all installed and loaded.
list.of.packages &lt;- c(&quot;ape&quot;,
                      &quot;Biostrings&quot;,
                      &quot;dplyr&quot;,
                      &quot;FastaUtils&quot;,
                      &quot;ORFik&quot;,
                      &quot;readr&quot;,
                      &quot;tidyr&quot;,
                      &quot;rBLAST&quot;,
                      &quot;seqinr&quot;,
                      &quot;stringr&quot;)

# Use lapply to load all of the packages in the list.
lapply(list.of.packages, require, character.only = TRUE)</code></pre>
<p>Load all the user-defined function located in <code>Functions/</code>:</p>
<pre class="r"><code># Load all of the functions written for DraftGenomeMineR     
files.sources &lt;- list.files(&quot;Functions&quot;, full.names=T)
sapply(files.sources, source)</code></pre>
</div>
<div id="setting-environment-for-blast-analysis" class="section level2" number="6.6">
<h2><span class="header-section-number">6.6</span> Setting environment for BLAST analysis</h2>
<p>To be able to navigate between folders within our project, we will set a object entitled <code>project.folder</code>, which contains the path to the root of the folder.</p>
<p>To create this object, do as follows:</p>
<pre class="r"><code>#Copy the output of getwd() in the object as follows:
project.folder &lt;- getwd()</code></pre>
<p>Call <code>project.folder</code> to check that it is right. It should be:
<code>"/home/bio_11/DraftGenomeMineR"</code> (with <code>bio_11</code> replaced by your account ID).</p>
<p>Set working directory to <code>project.folder</code> as follows:</p>
<pre class="r"><code>setwd(project.folder)</code></pre>
</div>
<div id="running-blast-analysis" class="section level2" number="6.7">
<h2><span class="header-section-number">6.7</span> Running BLAST analysis</h2>
<p>Set general parameters for the BLAST analysis:</p>
<pre class="r"><code># There are a few parameters that need to be set. Let&#39;s create some R objects to store file paths and parameters for the BLAST search.

# We need a query (a fasta file of a gene you want to find in the draft genome), a draft genome assembly, BLAST databases, paths to other required folders (described in the README), and other parameters that can be used to filter results.
query.file.path &lt;- &quot;FASTAs/PIP1_3.fa&quot;
genome.file.name &lt;- &quot;Draft_Genome_Assembly.fasta&quot;
genome.path &lt;- &quot;FASTAs/Draft_Genome_Assembly.fasta&quot;
blast.db.path &lt;- &quot;BlastDBs/Draft_Genome_Assembly.fasta&quot;
AA.BlastDB.folder &lt;- &quot;AA_BlastDB/&quot;
AA.ORF.folder &lt;- &quot;AA_ORFs/&quot;
max.e &lt;- 5E-50
perc.ident &lt;- 90.000
query.type &lt;- &quot;AA&quot;
blast.type &lt;- &quot;tblastn&quot;
make.BlastDB &lt;- T
BlastDB.type &lt;- &quot;nucl&quot;</code></pre>
<p>Read in the sagebrush draft genome assembly in <code>FASTA</code> format:</p>
<pre class="r"><code># Read in the genome assembly file
genome &lt;- readLines(con = genome.path)
head(genome) # Print the top 6 lines of the fasta. There should be no spaces in what is printed. Each header should be on one line, followed by its entire scaffold on the next.</code></pre>
<p>Make a BLAST database for query:</p>
<pre class="r"><code># Do you need to make a BLAST database or use an existing one?
if(make.BlastDB == TRUE){
  setwd(&quot;BlastDBs/&quot;)
  makeblastdb(file = genome.file.name, dbtype = BlastDB.type)
}</code></pre>
<p>Read in the query file in <code>FASTA</code> format:</p>
<pre class="r"><code># Read in the query. What type of molecule is the query? DNA (or RNA) or amino acid sequences?
setwd(project.folder) # Previous lines changed the wd, so we need to go back to the project folder.
if (query.type == &quot;DNA&quot;) {
  query &lt;- readDNAStringSet(filepath = query.file.path,
                            format = &quot;fasta&quot;)
} else {
  query &lt;- readAAStringSet(filepath = query.file.path,
                           format = &quot;fasta&quot;)
}</code></pre>
<p>Perform BLAST analysis (<code>BLAST</code> needs to be installed on the computer):</p>
<pre class="r"><code># Now we have everything set up and can perform a BLAST search.
bl &lt;- blast(db = blast.db.path, type = blast.type) # Create an object with the BLAST database and the type of BLAST search to perform.
cl &lt;- predict(bl, query) # Perform the BLAST search
head(cl) # Look at the top BLAST hits</code></pre>
<p>Filter output of BLAST analysis:</p>
<pre class="r"><code># We can now filter out bad BLAST hits using a few thresholds and parameters. This leaves us with only the best matches to our query.
# What parameters do you think would give you just the best candidates to be your gene of interest?
cl.filt &lt;- subset(x = cl, Perc.Ident &gt;= perc.ident &amp; E &lt;= max.e)
cl.filt.unique &lt;- cl.filt[!duplicated(cl.filt[,c(&#39;SubjectID&#39;)]),] # SubjectID is the column that contains the scaffold names
cl.filt.unique
nrow(cl)
nrow(cl.filt)
nrow(cl.filt.unique)
blast.hits.to.extract &lt;- subset(x = cl.filt.unique, SubjectID == cl.filt.unique[1,2]) </code></pre>
<p>Write output of BLAST analysis in <code>csv</code> file:</p>
<pre class="r"><code># We have evaluated the top BLAST hits and can see a clear best hit. Let&#39;s save this data so we can extract just that scaffold later.
write.csv(x = blast.hits.to.extract, file = &quot;Unique_Filtered_Blast_Hit_Info.csv&quot;, row.names = F)</code></pre>
</div>
</div>
<div id="mod2" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Module 2</h1>
<div id="objectives-1" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> Objectives</h2>
<p>In this module, we are conducting the following tasks:</p>
<ul>
<li>Setting up your working environment (as shown in <a href="#mod1.">module 1</a>)</li>
<li>Extracting scaffold(s) identified in <a href="#mod1">module 1</a> from the <em>de novo</em> draft genome assembly (in <code>FASTAs/Draft_Genome_Assembly.fasta</code>) and saving the output as a <code>FASTA</code> object/file.</li>
<li>Finding ORFs along scaffold(s) using the user-defined function <em>findORFsTranslateDNA2AA()</em> and saving the output into a <code>FASTA</code> object/file. In molecular genetics, an <strong>O</strong>pen <strong>R</strong>eading <strong>F</strong>rame (ORF) is the part of a reading frame that has the ability to be translated. An ORF is a continuous stretch of codons that begins with a start codon (usually AUG) and ends at a stop codon (usually UAA, UAG or UGA). We will study the code implemented in <em>findORFsTranslateDNA2AA()</em> to fully understand the applied approach.</li>
<li>Produce maps of recovered ORFs along scaffold(s). These <code>pdf</code> maps will be saved in <code>ORFs_map/</code>.</li>
</ul>
</div>
<div id="setting-up-your-working-environment" class="section level2" number="7.2">
<h2><span class="header-section-number">7.2</span> Setting up your working environment</h2>
<p>Before starting analyses in <code>R</code>, students have to complete these following tasks:</p>
<ol style="list-style-type: decimal">
<li>Remotely connect to their computers (using their individual accounts) with <code>ssh</code> protocol.</li>
<li>Navigate to project directory (<code>DraftGenomeMineR/</code>) using <code>cd</code>.</li>
<li>Create a new folder (<code>Output_FASTAs/</code>) using <code>mkdir</code> to store results of BLAST scaffold analysis.</li>
<li>Create a new folder (<code>ORFs_report/</code>) using <code>mkdir</code> to store results of ORFs analysis.</li>
<li>Start a new <code>R</code> session using <code>R-4</code> command.</li>
<li>Load R packages and user-defined functions.</li>
<li>Set working directory to <code>DraftGenomeMineR/</code>.</li>
</ol>
<p>For an example of code, see below:</p>
<pre class="r"><code>#1. ssh
ssh svenbuerki@132.178.142.214

#scp file
#scp DraftGenomeMineR.zip svenbuerki@132.178.142.214:/home/svenbuerki

#unzip file
#unzip DraftGenomeMineR.zip

#2. Navigate to DraftGenomeMineR/
cd DraftGenomeMineR/

#3. &amp; 4. Create new folders 
mkdir Output_FASTAs/
mkdir ORFs_report/
  
#5. Start R session
R-4

#6. This will make a list of packages that another function will use to make sure they are all installed and loaded.
list.of.packages &lt;- c(&quot;ape&quot;,
                      &quot;Biostrings&quot;,
                      &quot;dplyr&quot;,
                      &quot;FastaUtils&quot;,
                      &quot;ORFik&quot;,
                      &quot;readr&quot;,
                      &quot;tidyr&quot;,
                      &quot;rBLAST&quot;,
                      &quot;seqinr&quot;,
                      &quot;stringr&quot;)

# Use lapply to load all of the packages in the list.
lapply(list.of.packages, require, character.only = TRUE)

# Load all of the functions written for DraftGenomeMineR     
files.sources &lt;- list.files(&quot;Functions&quot;, full.names=T)
sapply(files.sources, source)

#7. Copy the output of getwd() in the object as follows:
project.folder &lt;- getwd()

#Set wd
setwd(project.folder)</code></pre>
</div>
<div id="extracting-scaffolds-in-de-novo-assembly" class="section level2" number="7.3">
<h2><span class="header-section-number">7.3</span> Extracting scaffold(s) in <em>de novo</em> assembly</h2>
<p>Open <code>Unique_Filtered_Blast_Hit_Info.csv</code> containing results of BLAST analysis and extract name of target scaffold(s).</p>
<pre class="r"><code>#Open BLAST file
cl.filt.unique &lt;- read.csv(file = &quot;Unique_Filtered_Blast_Hit_Info.csv&quot;) # Output of module 1

#Scaffold IDs
cl.filt.unique$SubjectID</code></pre>
<p>Extract scaffold(s) sequences from draft genome file (<code>FASTAs/Draft_Genome_Assembly.fasta</code>).</p>
<pre class="r"><code>#Open draft genome file
genome &lt;- readLines(&quot;FASTAs/Draft_Genome_Assembly.fasta&quot;)

#Check formatting of file
head(genome)

#How many scaffolds?
Nscaff &lt;- length(genome)/2

#Extract scaffolds in a loop

#Create data frame to store scaffold data
scaffold &lt;- data.frame(&quot;scaffoldID&quot; = character(length(cl.filt.unique$SubjectID)), &quot;scaffoldSeq&quot; = character(length(cl.filt.unique$SubjectID)))
#Start populating data frame
scaffold$scaffoldID &lt;- cl.filt.unique$SubjectID

for(i in 1:nrow(scaffold)){
  # Find and Extract seq of each scaffold from draft genome FASTA file
  scaffold$scaffoldSeq[i] &lt;- genome[match(paste0(&quot;&gt;&quot;,scaffold$scaffoldID[i]), genome)+1]
}

#Convert into FASTA format
scaffoldFASTA &lt;- apply(scaffold, 1, paste, collapse=&quot;\n&quot;)

#Save/export FASTA file
write.table(scaffoldFASTA, &quot;Output_FASTAs/Scaffold151535.fa&quot;, row.names = F, col.names=F, quote = F)</code></pre>
</div>
<div id="finding-orfs-along-scaffolds" class="section level2" number="7.4">
<h2><span class="header-section-number">7.4</span> Finding ORFs along scaffold(s)</h2>
<p>We will now find ORFs in scaffold(s) using <em>findORFsTranslateDNA2AA()</em>. This user-defined function relies on the <em>ORFik</em> R package. The output will be saved in <code>ORFs_report/</code>.</p>
<pre class="r"><code>scaffold &lt;- readLines(&quot;Output_FASTAs/Scaffold151535.fa&quot;)
scaffoldID &lt;- grep(pattern = &quot;^&gt;&quot;, x = scaffold, value = T)
scaffoldID &lt;- gsub(pattern = &quot;&gt;&quot;, replacement = &quot;&quot;, x = scaffoldID)
tryCatch(
  {
    for(i in 1:length(scaffoldID)){
      findORFsTranslateDNA2AA(scaffold = scaffold, scaffoldID = scaffoldID[i], MinLen = 40)
    }
  })</code></pre>
<p>We should now have ORFs reports and <code>FASTA</code> files of translated ORFs. Let’s check these outputs.</p>
<pre class="r"><code>orf.report &lt;- read.csv(&quot;ORFs_report/Scaffold151535_ORFs.csv&quot;)

#How many ORFs were found?
nrow(orf.report) 

#What are the longest ORFs?
orf.report[order(-orf.report$width),] 

#Look at translated ORFs (=AA sequences)
translated.orfs &lt;- readLines(&quot;AA_ORFs/Scaffold151535_ORFs.fa&quot;)
head(translated.orfs)</code></pre>
</div>
<div id="produce-maps-of-recovered-orfs-along-scaffolds" class="section level2" number="7.5">
<h2><span class="header-section-number">7.5</span> Produce maps of recovered ORFs along scaffold(s)</h2>
<p>Here, we are visualizing the ORFs recovered by our analysis along each scaffold by producing maps saved in <code>pdf</code> format in <code>ORFs_map/</code>. The code also checks if the folder <code>ORFs_map/</code> where files will be saved exists and if not creates it.</p>
<pre class="r"><code>###
#Build map of scaffold with ORFs
###

#Read scaffold FASTA file (line by line)
scaffold &lt;- readLines(&quot;Output_FASTAs/Scaffold151535.fa&quot;)

#List all files with ORFs
ORFfiles &lt;- list.files(path = &quot;ORFs_report&quot;, pattern = &quot;.csv&quot;, full.names = T)

#Check if folder where ORF maps will be saved exists
# if not then creates it
output_dir &lt;- file.path(paste0(getwd(), &quot;/ORFs_map/&quot;))

if(dir.exists(output_dir)){
  print(paste0(&quot;Dir&quot;, output_dir, &quot; already exists!&quot;))
}else{
  print(paste0(&quot;Created &quot;, output_dir))
  dir.create(output_dir)  
}

#Produce a map (in pdf format) for each scaffold
for(i in 1:length(ORFfiles)){
  print(ORFfiles[i])
  #Read file in
  ORF &lt;- read.csv(ORFfiles[i])
  
  #Process FASTA scaffold sequence
  seq &lt;- strsplit(scaffold[grep(paste(&quot;&gt;&quot;, ORF$scaffoldID[1], sep=&#39;&#39;), scaffold)+1], split=&#39;&#39;)
  
  #Separate ORFs by strand
  ORFplus &lt;- subset(ORF, ORF$strand == &quot;+&quot;)
  ORFneg &lt;- subset(ORF, ORF$strand == &quot;-&quot;)
  
  #Create plot
  pdf(paste(&quot;ORFs_map/&quot;, ORF$scaffoldID[1], &quot;_ORFs_annotated.pdf&quot;, sep=&#39;&#39;))
  
  #Initiate plot
  plot(x=1, y=1, xlim=c(0,length(seq[[1]])), ylim=c(0,2), type=&#39;n&#39;, bty=&quot;n&quot;, axes=F, xlab = &quot;&quot;, ylab=&#39;&#39;)
  #Add title
  text(x=5, y=2, paste(ORF$scaffoldID[1], &quot; (strand: + in grey and - in blue)&quot;, sep=&#39;&#39;), adj=0, cex=.8)
    
  #Create a segment with length of scaffold
  segments(x0=0, x1=length(seq[[1]]), y0=1, y1=1, col=&#39;black&#39;, lwd=3)
    
  #Add ORFs: rectangles (grey: +, blue: -)
  rect(xleft=ORFplus$start, xright=ORFplus$end, ybottom=0.75, ytop=1.25, col=&#39;grey&#39;)
  rect(xleft=ORFneg$start, xright=ORFneg$end, ybottom=0.75, ytop=1.25, col=&#39;blue&#39;)
  text(x=(ORFneg$start + ORFneg$end)/2, y=0.7, paste(ORFneg$ORFID, &quot; (&quot;, ORFneg$start, &quot;:&quot;, ORFneg$end, &quot;)&quot;, sep=&#39;&#39;), srt=90, col=&#39;blue&#39;, adj=1, cex=0.4)
  text(x=(ORFplus$start + ORFplus$end)/2, y=1.3, paste(ORFplus$ORFID, &quot; (&quot;, ORFplus$start, &quot;:&quot;, ORFplus$end, &quot;)&quot;, sep=&#39;&#39;), srt=90, col=&#39;black&#39;, adj=0, cex=0.4)
    
  #Add x axis
  axis(side = 1)
  mtext(&quot;Sequence (bp)&quot;, pos = c(0,0.5), side=1, line=2, cex.lab=0.6,las=1)
  #Close pdf
  dev.off()
}</code></pre>
<p>Figure <a href="#fig:scaffmap">7.1</a> shows the location of predicted ORFs along <code>Scaffold151535</code> inferred by the code displayed above.</p>
<div class="figure"><span id="fig:scaffmap"></span>
<img src="Images/Scaffold151535_ORFs_annotated.png" alt="Map of predicted ORFs along scaffold151535." width="100%" />
<p class="caption">
Figure 7.1: Map of predicted ORFs along scaffold151535.
</p>
</div>
</div>
</div>
<div id="mod3" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Module 3</h1>
<div id="objectives-2" class="section level2" number="8.1">
<h2><span class="header-section-number">8.1</span> Objectives</h2>
<p>In this module, we are conducting the following tasks:</p>
<ol style="list-style-type: decimal">
<li>Annotate ORFs inferred in <a href="#mod2">module 2</a> using online protein <a href="https://blast.ncbi.nlm.nih.gov/Blast.cgi?PROGRAM=blastp&amp;PAGE_TYPE=BlastSearch&amp;LINK_LOC=blasthome">BLAST</a> tool. Students will use the output of the protein BLAST analysis to identify ORF(s) coding for Aquaporin genes.</li>
<li>Extract ORF(s) identified by protein BLAST analysis to reconstruct Aquaporin gene sequence. Students will provide DNA sequence of Aquaporin gene located on scaffold and its associated protein sequence.</li>
</ol>
</div>
<div id="annotate-orfs-using-online-protein-blast-tool" class="section level2" number="8.2">
<h2><span class="header-section-number">8.2</span> Annotate ORFs using online protein BLAST tool</h2>
<div id="input-file-for-protein-blast-analysis" class="section level3" number="8.2.1">
<h3><span class="header-section-number">8.2.1</span> Input file for protein BLAST analysis</h3>
<p>The <code>FASTA</code> file <code>Scaffold151535_ORFs.fa</code> (see Figure <a href="#fig:scafAAseqFASTA">8.1</a>) containing AA sequences of ORFs identified in <a href="#mod2">module 2</a> is available on the shared Google Drive <a href="https://drive.google.com/drive/folders/1d0TSt_M-wAVmNPPfMnXtxD8_fnfK7jQr?usp=sharing">here</a>.</p>
<div class="figure"><span id="fig:scafAAseqFASTA"></span>
<img src="Images/Scaffolds_AA_seq_ORFs.png" alt="FASTA file containing all AA sequences for ORFs inferred along scaffold. See module 2 for more details." width="100%" />
<p class="caption">
Figure 8.1: FASTA file containing all AA sequences for ORFs inferred along scaffold. See module 2 for more details.
</p>
</div>
</div>
<div id="protein-blast-analysis" class="section level3" number="8.2.2">
<h3><span class="header-section-number">8.2.2</span> Protein BLAST analysis</h3>
<ol style="list-style-type: decimal">
<li>Students download input file on their personal computers and open it in their favorite text editor.</li>
<li>Go on the online protein <a href="https://blast.ncbi.nlm.nih.gov/Blast.cgi?PROGRAM=blastp&amp;PAGE_TYPE=BlastSearch&amp;LINK_LOC=blasthome">BLAST</a> platform <span class="citation">(described in <a href="#ref-altschul1997gapped" role="doc-biblioref">Altschul et al., 1997</a>)</span>.</li>
<li>Copy content of <code>Scaffold151535_ORFs.fa</code> as shown in Figure <a href="#fig:protBLASTinput">8.2</a> and press <code>BLAST</code> button to send the query.
<div class="figure"><span id="fig:protBLASTinput"></span>
<img src="Images/proteinBLASTinputform.png" alt="Online protein BLAST form." width="100%" />
<p class="caption">
Figure 8.2: Online protein BLAST form.
</p>
</div></li>
<li>Inspect output of protein BLAST analysis and identified ORF(s) along scaffold coding for Aquaporin gene products (see <a href="#fig:protBLASToutput">8.3</a>).
<div class="figure"><span id="fig:protBLASToutput"></span>
<img src="Images/proteinBLASToutput.png" alt="Output of the protein BLAST analysis. Use the dropdown button to select each ORF and identify their gene products." width="100%" />
<p class="caption">
Figure 8.3: Output of the protein BLAST analysis. Use the dropdown button to select each ORF and identify their gene products.
</p>
</div></li>
<li>What ORFs are coding for Aquaporin gene products?</li>
</ol>
</div>
</div>
<div id="extract-orfs-identified-by-protein-blast-analysis-to-reconstruct-aquaporin-gene-sequence" class="section level2" number="8.3">
<h2><span class="header-section-number">8.3</span> Extract ORF(s) identified by protein BLAST analysis to reconstruct Aquaporin gene sequence</h2>
<p>Students are tasked to develop an R code producing the DNA sequence of Aquaporin gene located on identified scaffold and its associated protein sequence.</p>
</div>
</div>
<div id="mod4" class="section level1" number="9">
<h1><span class="header-section-number">9</span> Module 4</h1>
<div id="objectives-3" class="section level2" number="9.1">
<h2><span class="header-section-number">9.1</span> Objectives</h2>
<p>The objectives of this module are to validate the AQP protein sequences obtained in <a href="#mod3">module 3</a> and infer its function. This will be done by conducting the following analyses:</p>
<ol style="list-style-type: decimal">
<li>Prediction of protein transmembrane helices based on the approach implemented in <a href="http://www.cbs.dtu.dk/services/TMHMM/">TMHMM</a> <span class="citation">(<a href="#ref-krogh2001predicting" role="doc-biblioref">Krogh et al., 2001</a>)</span>. This approach relies on <a href="https://www.sciencedirect.com/topics/biochemistry-genetics-and-molecular-biology/hidden-markov-model">Hidden Markov Models</a>.</li>
<li>Identifying NPA motifs using R script relying on <em>Biostring</em> <span class="citation">(<a href="#ref-Biostrings" role="doc-biblioref">Pagès et al., 2019</a>)</span> package.</li>
<li>Model 3D AQP protein using approach implemented in <a href="http://www.sbg.bio.ic.ac.uk/~phyre2/html/page.cgi?id=index">Phyre<sup>2</sup></a> and predict protein (therefore its function). The approach for protein modeling, prediction and analysis is presented in <span class="citation"><a href="#ref-kelley2015phyre2" role="doc-biblioref">Kelley et al.</a> (<a href="#ref-kelley2015phyre2" role="doc-biblioref">2015</a>)</span>.</li>
</ol>
<div id="predictions" class="section level3" number="9.1.1">
<h3><span class="header-section-number">9.1.1</span> Predictions</h3>
<p>To be valid, the AQP protein sequence should have:</p>
<ol style="list-style-type: decimal">
<li>Six transmembrane helices and two loops.</li>
<li>Each loop should contain an NPA motif.</li>
<li>Mutations in NPA motifs will indicate changes in the channeled molecule (therefore changing its function).</li>
</ol>
</div>
</div>
<div id="prediction-of-protein-transmembrane-helices-and-outside-loops" class="section level2" number="9.2">
<h2><span class="header-section-number">9.2</span> Prediction of protein transmembrane helices (and outside loops)</h2>
<p>To conduct this analysis (based on <code>&gt;Scaffold151535_ORF_26</code>) do the following:</p>
<ol style="list-style-type: decimal">
<li>Go to the TMHMM website: <a href="http://www.cbs.dtu.dk/services/TMHMM/" class="uri">http://www.cbs.dtu.dk/services/TMHMM/</a></li>
<li>Paste the <code>FASTA</code> AA sequence generated in <a href="#mod3">module 3</a>, here corresponding to <code>Scaffold151535_ORF_26</code> as shown in Figure <a href="#fig:TMHMMinput">9.1</a> and submit the analysis.
<div class="figure"><span id="fig:TMHMMinput"></span>
<img src="Images/TMHMM_input.png" alt="Snapshot of TMHMM website showing how to submit job." width="100%" />
<p class="caption">
Figure 9.1: Snapshot of TMHMM website showing how to submit job.
</p>
</div></li>
<li>Inspect output of TMHMM analysis (see Figure <a href="#fig:TMHMMoutput">9.2</a>). For AQP proteins, we expect:
<ul>
<li>Number of predicted TMHs (= <strong>T</strong>rans-<strong>M</strong>embrane <strong>H</strong>elix): 6.</li>
<li>Outside loops: 2.
<div class="figure"><span id="fig:TMHMMoutput"></span>
<img src="Images/TMHMM_results.png" alt="Snapshot of TMHMM results." width="100%" />
<p class="caption">
Figure 9.2: Snapshot of TMHMM results.
</p>
</div></li>
</ul></li>
</ol>
</div>
<div id="identifying-npa-motifs" class="section level2" number="9.3">
<h2><span class="header-section-number">9.3</span> Identifying NPA motifs</h2>
</div>
<div id="model-3d-aqp-protein" class="section level2" number="9.4">
<h2><span class="header-section-number">9.4</span> Model 3D AQP protein</h2>
<p>To model 3D structure of AQP protein and predict its function do the following (here based on <code>&gt;Scaffold151535_ORF_26</code>):</p>
<ol style="list-style-type: decimal">
<li>Go to Phyre<sup>2</sup> website: <a href="http://www.sbg.bio.ic.ac.uk/~phyre2/html/page.cgi?id=index" class="uri">http://www.sbg.bio.ic.ac.uk/~phyre2/html/page.cgi?id=index</a></li>
<li>Copy <code>FASTA</code> AA sequence and fill form as shown in Figure <a href="#fig:phyreinput">9.3</a>. Once completed, please submit job by pressing <code>Phyre Search</code>. The job will take ca. 50 minutes to run.
<div class="figure"><span id="fig:phyreinput"></span>
<img src="Images/Phyre2_input.png" alt="Snapshot of Phyre2 website used to model 3D structure of protein and predict its function." width="100%" />
<p class="caption">
Figure 9.3: Snapshot of Phyre2 website used to model 3D structure of protein and predict its function.
</p>
</div></li>
<li>You will relieve an email when the analysis is completed. A link to the output of the Phyre<sup>2</sup> analysis will send you to the report page as shown in Figure <a href="#fig:phyreoutput">9.4</a>.
<div class="figure"><span id="fig:phyreoutput"></span>
<img src="Images/Phyre2_output.png" alt="Results of Phyre2 analysis." width="100%" />
<p class="caption">
Figure 9.4: Results of Phyre2 analysis.
</p>
</div></li>
<li>Note that although the AQP protein sequence is not complete, the analysis still modeled it correctly and predicts that it belong to the <em>PIP</em> subfamily (see Figure <a href="#fig:phyreoutput">9.4</a>).</li>
</ol>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1>References</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-altschul1997gapped" class="csl-entry">
<span class="smallcaps">Altschul, S.F.</span>, <span class="smallcaps">T.L. Madden</span>, <span class="smallcaps">A.A. Schäffer</span>, <span class="smallcaps">J. Zhang</span>, <span class="smallcaps">Z. Zhang</span>, <span class="smallcaps">W. Miller</span>, and <span class="smallcaps">D.J. Lipman</span>. 1997. Gapped BLAST and PSI-BLAST: A new generation of protein database search programs. <em>Nucleic acids research</em> 25: 3389–3402.
</div>
<div id="ref-chaumont2005regulation" class="csl-entry">
<span class="smallcaps">Chaumont, F.</span>, <span class="smallcaps">M. Moshelion</span>, and <span class="smallcaps">M.J. Daniels</span>. 2005. Regulation of plant aquaporin activity. <em>Biology of the Cell</em> 97: 749–764.
</div>
<div id="ref-danielson2008unexpected" class="csl-entry">
<span class="smallcaps">Danielson, J.Å.</span>, and <span class="smallcaps">U. Johanson</span>. 2008. Unexpected complexity of the aquaporin gene family in the moss physcomitrella patens. <em>BMC plant biology</em> 8: 1–15.
</div>
<div id="ref-ishibashi2006aquaporin" class="csl-entry">
<span class="smallcaps">Ishibashi, K.</span> 2006. Aquaporin subfamily with unusual NPA boxes. <em>Biochimica et Biophysica Acta (BBA)-Biomembranes</em> 1758: 989–993.
</div>
<div id="ref-kelley2015phyre2" class="csl-entry">
<span class="smallcaps">Kelley, L.A.</span>, <span class="smallcaps">S. Mezulis</span>, <span class="smallcaps">C.M. Yates</span>, <span class="smallcaps">M.N. Wass</span>, and <span class="smallcaps">M.J. Sternberg</span>. 2015. The Phyre2 web portal for protein modeling, prediction and analysis. <em>Nature protocols</em> 10: 845–858.
</div>
<div id="ref-krogh2001predicting" class="csl-entry">
<span class="smallcaps">Krogh, A.</span>, <span class="smallcaps">B. Larsson</span>, <span class="smallcaps">G. Von Heijne</span>, and <span class="smallcaps">E.L. Sonnhammer</span>. 2001. Predicting transmembrane protein topology with a hidden markov model: Application to complete genomes. <em>Journal of molecular biology</em> 305: 567–580.
</div>
<div id="ref-li2014plant" class="csl-entry">
<span class="smallcaps">Li, G.</span>, <span class="smallcaps">V. Santoni</span>, and <span class="smallcaps">C. Maurel</span>. 2014. Plant aquaporins: Roles in plant physiology. <em>Biochimica et Biophysica Acta (BBA)-General Subjects</em> 1840: 1574–1582.
</div>
<div id="ref-Biostrings" class="csl-entry">
<span class="smallcaps">Pagès, H.</span>, <span class="smallcaps">P. Aboyoun</span>, <span class="smallcaps">R. Gentleman</span>, and <span class="smallcaps">S. DebRoy</span>. 2019. Biostrings: Efficient manipulation of biological strings.
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
